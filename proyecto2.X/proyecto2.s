;*******************************************************************************
; Universidad del Valle de Guatemala
; IE2023 ProgramaciOn de Microcontroladores
; Autor: ALDO AVILA
; Compilador: PIC-AS (v2.36), MPLAB X IDE (v6.00)
; Proyecto: HDT2
; Hardware: PIC16F887
; Creado: 23/08/22
;******************************************************************************* 
;******************************************************************************* 
; Palabra de configuraciÃƒÂ³n    
;******************************************************************************* 
 ; CONFIG1
  CONFIG  FOSC = INTRC_NOCLKOUT ; Oscillator Selection bits (INTOSCIO oscillator
				; : I/O function on RA6/OSC2/CLKOUT pin, I/O 
				; function on RA7/OSC1/CLKIN)
  CONFIG  WDTE = OFF            ; Watchdog Timer Enable bit (WDT disabled and 
				; can be enabled by SWDTEN bit of the WDTCON register)
  CONFIG  PWRTE = OFF           ; Power-up Timer Enable bit (PWRT disabled)
  CONFIG  MCLRE = OFF           ; RE3/MCLR pin function select bit (RE3/MCLR pin function is digital input, MCLR internally tied to VDD)
  CONFIG  CP = OFF              ; Code Protection bit (Program memory code protection is disabled)
  CONFIG  CPD = OFF             ; Data Code Protection bit (Data memory code protection is disabled)
  CONFIG  BOREN = OFF           ; Brown Out Reset Selection bits (BOR disabled)
  CONFIG  IESO = OFF            ; Internal External Switchover bit (Internal/External Switchover mode is disabled)
  CONFIG  FCMEN = OFF           ; Fail-Safe Clock Monitor Enabled bit (Fail-Safe Clock Monitor is disabled)
  CONFIG  LVP = OFF             ; Low Voltage Programming Enable bit (RB3 pin has digital I/O, HV on MCLR must be used for programming)

; CONFIG2
  CONFIG  BOR4V = BOR40V        ; Brown-out Reset Selection bit (Brown-out Reset set to 4.0V)
  CONFIG  WRT = OFF             ; Flash Program Memory Self Write Enable bits (Write protection off)

PROCESSOR 16F887
#include <xc.inc>
 ;******************************************************************************* 
; Variables    
;******************************************************************************* 
PSECT udata_bank0
 cont10ms:
    DS 1
 NL:
    DS 1
 NH:
    DS 1
 MH:
    DS 1
 ML:
    DS 1
 HL:
    DS 1
 HH:
    DS 1
 DL:
    DS 1
 DH:
    DS 1
 AL:
    DS 1
 AH:
    DS 1
 ALARMA_ML:
    DS 1
 ALARMA_MH:
    DS 1
 ALARMA_HL:
    DS 1
 ALARMA_HH:
    DS 1
 DIS:
    DS 1
 CONTADOR:
    DS 3 
 CONT_DIS:
    DS 1
 ALARMA:
    DS 2
 CONTADOR_F:
    DS 2
 CONTADOR_M:
    DS 1
 CONTADOR_ES:
    DS 1
 FLAG:
    DS 2
 W_TEMP:
    DS 1
 STATUS_TEMP:
    DS 1
 CONT20MS:
    DS 1

;******************************************************************************* 
; Vector Reset    
;******************************************************************************* 
PSECT CODE, delta=2, abs
 ORG 0x0000
    PAGESEL MAIN
    goto MAIN
;******************************************************************************* 
; Vector ISR Interrupciones    
;******************************************************************************* 
PSECT CODE, delta=2, abs
 ORG 0x0004
 PUSH:
    MOVWF W_TEMP
    SWAPF STATUS, W
    MOVWF STATUS_TEMP

ISR:			    ; EN ESTA PARTE DEL CODIGO SE REVISA QUE BANDERA FUE
			    ; LA QUE ACTIVO LA INTERRUPCION
    BTFSC   RBIF
    GOTO    ISRRBIF
    BTFSC   TMR1IF
    GOTO    ISRTMR1
    BTFSC   TMR0IF
    GOTO    ISRTMR0
    GOTO    SALIDA
    
ISRRBIF:		    ; AQUI CREAMOS NUESTRA MAQUINA DE ESTADOS FINITOS
    ;BTFSS   INTCON, 0	    ; RBIF = 1 ?
    ;GOTO    ISRTMR1	    ; SI NO ESTA ENCENDIDO VAMOS A POP
    BANKSEL PORTB
    BTFSS   PORTB, 0
    INCF    CONTADOR_ES, F  ; CADA VEZ QUE SE PRESION EL BOTON QUE SE ENCUENTRA
			    ; EN EL BIT 0 DE PORTB, SE AUMENTARA UN CONTADOR QUE
			    ; NOS DARA EL ESTADO EN EL QUE ESTAREMOS
    BCF	    RBIF	    ; APAGAMOS LA BANDERA DE LA INTERRUPCION
    GOTO    MOD_HORA	    ; VAMOS AL MODO HORA
    GOTO    SALIDA
    
MOD_HORA:		    ; AQUI SE REVISA QUE BOTON SE PRESIONO, Y 
			    ; DEPENDIENDO DE CUAL SEA, SE ENCIENDE EL BIT DE UNA
			    ; BANDERA
    BTFSS PORTB, 1
    BSF FLAG, 1
    BTFSS PORTB, 2
    BSF FLAG, 2
    BTFSS PORTB, 3
    BSF FLAG, 3
    BTFSS PORTB, 4
    BSF FLAG, 4
    GOTO SALIDA

    

ISRTMR1:		    ; INCREMENTAMOS LA VARIABLE DE NL CADA SEGUNDO
    ;BTFSS PIR1, 0	    ; TMR1IF = 1?
    ;GOTO ISR
    BCF PIR1, 0		    ; Borramos la bandera del TMR1IF
    MOVLW 0x7C
    MOVWF TMR1L
    MOVLW 0xE1
    MOVWF TMR1H
    INCF NL
    
ISRTMR0:		    ; ESTE TIEMPO SERA EL QUE SE TARDARA EN CAMBIAR DE 
			    ; DISPLAY
    ;BTFSS INTCON,2	; T0IF = 1 ?
    ;GOTO SALIDA
    BANKSEL TMR0
    MOVLW 220
    MOVWF TMR0		; CARGAMOS EL VALOR DE N = DESBORDE 50mS
    BCF T0IF		; Borramos bandera T0IF 
    INCF cont10ms, F
    ;GOTO POP
    GOTO DIS0
    
DIS0:
    BANKSEL PORTA
    MOVF CONT_DIS, W
    SUBLW 0		    ; REALIZAMOS UNA COMPARACION DEL VALOR DE CONTADOR
			    ; SI ESTA ES 0 SEGUIMOS EN ESTA SUBRUTINA, SINO
			    ; PASAMOS A A VERIFICAR EL SIGUIENTE DISPLAY
    BTFSS STATUS, 2
    GOTO DIS1
    MOVLW 0b00000001
    MOVWF PORTA
    INCF CONT_DIS
    BCF INTCON, 0
    GOTO SALIDA
    
DIS1:
    MOVF CONT_DIS, W
    SUBLW 1		    ; REALIZAMOS UNA COMPARACION DEL VALOR DE CONTADOR
			    ; SI ESTA ES 0 SEGUIMOS EN ESTA SUBRUTINA, SINO
			    ; PASAMOS A A VERIFICAR EL SIGUIENTE DISPLAY
    BTFSS STATUS, 2
    GOTO DIS2
    MOVLW 0b00000010
    MOVWF PORTA
    INCF CONT_DIS	    ; INCREMENTAMOS ESTA VARIABLE PARA ASI CAMBIAR DE
			    ; DISPLAY LA PROXIMA VEZ QUE SE DE LA INTERRUPCION
    BCF INTCON, 0
    GOTO SALIDA

DIS2:
    MOVF CONT_DIS, W
    SUBLW 2		    ; REALIZAMOS UNA COMPARACION DEL VALOR DE CONTADOR
			    ; SI ESTA ES 0 SEGUIMOS EN ESTA SUBRUTINA, SINO
			    ; PASAMOS A A VERIFICAR EL SIGUIENTE DISPLAY
    BTFSS STATUS, 2
    GOTO DIS3
    MOVLW 0b00000100
    MOVWF PORTA
    INCF CONT_DIS
    BCF INTCON, 0
    GOTO SALIDA
DIS3:
    MOVF CONT_DIS, W
    SUBLW 3		    ; REALIZAMOS UNA COMPARACION DEL VALOR DE CONTADOR
			    ; SI ESTA ES 0 SEGUIMOS EN ESTA SUBRUTINA, SINO
			    ; PASAMOS A A VERIFICAR EL SIGUIENTE DISPLAY
    BTFSS STATUS, 2
    GOTO DIS4
    MOVLW 0b00001000
    MOVWF PORTA
    INCF CONT_DIS
    BCF INTCON, 0
    GOTO SALIDA
    
DIS4:
    MOVF CONT_DIS, W
    SUBLW 4		    ; REALIZAMOS UNA COMPARACION DEL VALOR DE CONTADOR
			    ; SI ESTA ES 0 SEGUIMOS EN ESTA SUBRUTINA, SINO
			    ; PASAMOS A A VERIFICAR EL SIGUIENTE DISPLAY
    BTFSS STATUS, 2
    GOTO DIS5
    MOVLW 0b00010000
    MOVWF PORTA
    INCF CONT_DIS
    BCF INTCON, 0
    GOTO SALIDA
    
DIS5:

    MOVLW 0b00100000	    ; ENCENDEMOS EL ULTIMO DISPLAY Y LIMPIAMOS LA 
			    ; VARIABLE QUE ONS INDICABA QUE DISPLAY TOCABA
			    ; PARA QUE SE REINICIA EL CICLO
    MOVWF PORTA
    CLRF CONT_DIS
    ;GOTO POP
    

SALIDA:
    NOP
POP:
    SWAPF STATUS_TEMP, W
    MOVWF STATUS
    SWAPF W_TEMP, F
    SWAPF W_TEMP, W
    RETFIE
;******************************************************************************* 
; CÃƒÂ³digo Principal    
;******************************************************************************* 
PSECT CODE, delta=2, abs
 ORG 0x0100
 ;******************************************************************************* 
; Tabla para obtener el valor del puerto a mostrar para el display 7 Seg  
;*******************************************************************************     

MAIN:
    BANKSEL OSCCON
    
    BCF OSCCON, 6	; IRCF2 SelecciÃƒÂ³n de 2MHz
    BSF OSCCON, 5	; IRCF1
    BCF OSCCON, 4	; IRCF0
    
    BSF OSCCON, 0	; SCS Reloj Interno
   
    BANKSEL ANSEL
    CLRF ANSEL
    CLRF ANSELH
    
    BANKSEL TRISC
    CLRF TRISC		; Limpiar el registro TRISC, A Y D
    CLRF TRISA
    CLRF TRISD
    
    BSF TRISB, 0	; Entradas para los botones
    BSF TRISB, 1	
    BSF TRISB, 2
    BSF TRISB, 3
    BSF TRISB, 4
    
    BANKSEL WPUB
    BSF WPUB, 0
    BSF WPUB, 1		; Habilitando los Pullups en RB0, 1, 2, 3, 4
    BSF WPUB, 2
    BSF WPUB, 3
    BSF WPUB, 4
    
    BANKSEL OPTION_REG
    BCF OPTION_REG, 7	; HABILITANDO PULLUPS PUERTO B
    BCF OPTION_REG, 5	; T0CS: FOSC/4 COMO RELOJ (MODO TEMPORIZADOR)
    BCF OPTION_REG, 3	; PSA: ASIGNAMOS EL PRESCALER AL TMR0
    
    BSF OPTION_REG, 2
    BSF OPTION_REG, 1
    BCF OPTION_REG, 0	; PS2-0: PRESCALER 1:128 SELECIONADO 
    
    BANKSEL INTCON
    
    BSF INTCON, 7	; Se habilitan todas las interrupciones por el GIE
    BSF INTCON, 5	; Habilitando la interrupcion T0IE TMR0
    BSF INTCON,	3	; Se habilita la interrupciÃƒÂ³n del RBIE
    BCF INTCON, 2	; Apagamos la bandera T0IF del TMR0 
    BCF INTCON, 0
    
   
    
    BANKSEL IOCB
    BSF IOCB, 0
    BSF IOCB, 1		
    BSF IOCB, 2
    BSF IOCB, 3
    BSF IOCB, 4		; Habilitando RB0, 1, 2, 3 Y 4 para las ISR de RBIE
    banksel PORTB
    movf    PORTB,W	;Es necesario escribir/leer el puerto y 
			;limpiar la bndera luego de configurar IOCB
    bcf	    RBIF
    
    BANKSEL PIE1
    BSF PIE1, 0
    
    BANKSEL PIR1
    BCF PIR1, 0
    
    BANKSEL T1CON
    BSF T1CON, 5
    BSF T1CON, 4	; Prescaler de 1:8  
    BCF T1CON, 1	; TMR1CS Fosc/4 reloj interno
    BSF T1CON, 0	; TMR1ON enable
    
    BANKSEL TMR1L	; SE ASIGNAN LOS VARIABLES DEL TIMER1
    MOVLW 0x7C
    MOVWF TMR1L
    MOVLW 0xE1
    MOVWF TMR1H
    
    
    ; ConfiguraciÃƒÂ³n TMR0

    
    BANKSEL PORTC
    CLRF PORTC		; Se limpia el puerto C D ^ A
    CLRF PORTD
    CLRF PORTA


    CLRF CONTADOR_M	; SE LIMPIAN TODAS LAS VARIABLES
    CLRF CONTADOR_ES
    CLRF CONTADOR
    CLRF CONTADOR_F
    CLRF CONTADOR_ES
    CLRF CONT_DIS
    CLRF ALARMA
    CLRF CONT20MS
    CLRF CONT_DIS
    CLRF NL
    CLRF NH
    CLRF ML
    CLRF MH
    CLRF HL
    CLRF HH
    CLRF DL
    CLRF DH
    CLRF AL
    CLRF AH
    CLRF ALARMA_ML
    CLRF ALARMA_MH
    CLRF ALARMA_HL
    CLRF ALARMA_HH
    CLRF FLAG
    MOVLW 220
    MOVWF TMR0		; CARGAMOS EL VALOR DE N = DESBORDE 50mS
    
SETCONTADOR:		; AQUI SEPARAMOS TODAS LAS VARIABLES PARA EL MULTI-
			; PLEXADO
			; SE DIVIDE EN TRES PARTES, LAS VARIABLES DE LA HORA,
			; LAS DE LA FECHA Y LAS DE LA ALARMA
    
    MOVF CONTADOR, W
    MOVWF PORTD
    
    MOVWF NL
    MOVWF NH
    MOVWF ML
    MOVWF MH
    MOVWF HL
    MOVWF HH

    MOVLW 0x0F		; SE CARGA UN VALOR A LA MITAD Y LO DEMAS SE VUELVE 0
    ANDWF NL, F
    
    MOVLW 0xF0		; SE CARGA UN VALOR A LA MITAD Y LO DEMAS SE VUELVE 0 
			; DESPUES SE LE DA LA VUELTA
    ANDWF NH, F
    SWAPF NH, F
    
    MOVLW 0x0F
    ANDWF ML, F
    
    MOVLW 0xF0
    ANDWF MH, F
    SWAPF MH, F

    MOVLW 0x0F
    ANDWF HL, F
    
    MOVLW 0xF0
    ANDWF HH, F
    SWAPF HH, F
;******************************************************************************* 
; MUX DE FECHA
;*******************************************************************************     
    MOVF CONTADOR_F, W
    MOVWF PORTD
    
    MOVWF DL
    MOVWF DH
    MOVWF AL
    MOVWF AH

    MOVLW 0x0F
    ANDWF DL, F
    
    MOVLW 0xF0
    ANDWF DH, F
    SWAPF DH, F
    
    MOVLW 0x0F
    ANDWF AL, F
    
    MOVLW 0xF0
    ANDWF AH, F
    SWAPF AH, F
    
    INCF DL
    INCF AL
;******************************************************************************* 
; MUX DE ALARMA
;*******************************************************************************  
    MOVF ALARMA, W
    MOVWF PORTD
    
    MOVWF ALARMA_ML
    MOVWF ALARMA_MH
    MOVWF ALARMA_HL
    MOVWF ALARMA_HH

    MOVLW 0x0F
    ANDWF ALARMA_ML, F
    
    MOVLW 0xF0
    ANDWF ALARMA_MH, F
    SWAPF ALARMA_MH, F
    
    MOVLW 0x0F
    ANDWF ALARMA_HL, F
    
    MOVLW 0xF0
    ANDWF ALARMA_HH, F
    SWAPF ALARMA_HH, F
    
    INCF ALARMA_HL
    
  
   
LOOP:

    GOTO VERIFICACION_ES0	; VERIFICAMOS EN QUE ESTADO SE ENCEUNTRA
    
VERIFICACION_ES0:		; EN ESTE ESTADO EL RELOJ MUESTRA LOS SEGUNDOS
				; DE FORMA NORMAL
    BANKSEL PORTA
    MOVF CONTADOR_ES, W		
    SUBLW 0
    BTFSS STATUS, 2		; HACEMOS UNA VERIFICACION PARA VER EN QUE 
				; ESTADO SE ENCUENTRA
    GOTO VERIFICACION_ES1	; SI LA RESTA NO ES 0, REVISAMOS EL SIGUIENTE
				; ESTADO
    BSF PORTA, 6		; ENCENDEMOS LA LED PARA INDICAR EL ESTADO
    GOTO DIS_0			; VAMOS A DIS_0
    
VERIFICACION_ES1:		; EN ESTE ESTADO SE MOSTRARA LA FECHA
    BANKSEL PORTA
    MOVF CONTADOR_ES, W
    SUBLW 1
    BTFSS STATUS, 2
    GOTO VERIFICACION_ES2
    BCF PORTA, 6		; SE ENCENDERAN LAS LEDS RESPECTIVAS DEL ESTADO
    BSF PORTA, 7
    GOTO DIS_0F			; VAMOS A DIS_0F
    
VERIFICACION_ES2:		; AQUI PODREMOS MODIFICAR LA HORA DEL RELOJ
    BANKSEL PORTA
    MOVF CONTADOR_ES, W
    SUBLW 2
    BTFSS STATUS, 2
    GOTO VERIFICACION_ES3
    CALL INC_TEMPM		; LLAMAMOS A INC_TEMPM
    CALL DEC_TEMPM		; LLAMAMOS A DEC_TEMPM
    CALL INC_TEMPH		; LLAMAMOS A INC_TEMPH
    CALL DEC_TEMPH		; LLAMAMOS A DEC_TEMPH
    CALL INC_M			; LLAMAMOS A INC_M
    CALL INC_H			; LLAMAMOS A INC_H
    CALL INC_HH			; LLAMAMOS A INC_HH
    GOTO DIS_0
INC_TEMPM:			; SI SE PRESIONA EL BOTON DEL BIT 1 DE PORTB
				; SE INCREMENTA EN 1 EL VALOR DE LOS MINUTOS
    BTFSS FLAG, 1
    RETURN
    INCF ML
    CLRF FLAG
    RETURN
DEC_TEMPM:			; SI SE PRESIONA EL BOTON DEL BIT 2 DE PORTB
				; SE DECREMENTA EL VALOR DE LOS MINUTOS
    BTFSS FLAG, 2
    RETURN
    DECF ML
    CLRF FLAG
    RETURN
INC_TEMPH:			; SI SE PRESIONA EL BOTON DEL BIT 3 DE PORTB
				; SE INCREMENTA EL VALOR DE LAS HORAS
    BTFSS FLAG, 3
    RETURN
    INCF HL
    CLRF FLAG
    RETURN
DEC_TEMPH:			; SI SE PRESIONA EL BOTON DEL BIT 4 DE PORTB 
				; SE DECREMENTA EL VALOR DE LAS HORAS
    BTFSS FLAG, 4
    RETURN
    DECF HL
    CLRF FLAG
    RETURN
INC_M:				; REVISA EL VALOOR DE LOS MINUTOS PARA QUE NO
				; SE PASE DE 60
    MOVF ML, W
    SUBLW 10
    BTFSS STATUS, 2
    RETURN
    CLRF ML
    INCF MH, F
    MOVF MH, W		; MOVEMOS LOS DATOS DEL CONTADOR2 A W
    SUBLW 6		; LE RESTAMOS 6
    BTFSS STATUS, 2	; SI LA RESTA ES 0 NOS SALTAMOS RETURN
    RETURN		
    CLRF MH
    RETURN   
INC_H:			    ; REVISAMOS QUE LAS HORAS NO SE PASEN DE 10
    MOVF HL, W
    SUBLW 10
    BTFSS STATUS, 2
    RETURN
    CLRF HL
    INCF HH, F
    RETURN    
INC_HH:			    ; REVISAMOS LAS HORAS PARA QUE CUANDO LLEGUEN A 24
			    ; SE REINICIEN LOS VALORES DE LAS HORAS
    MOVF HH, W
    SUBLW 2
    BTFSS STATUS, 2
    RETURN
    MOVF HL, W
    SUBLW 4
    BTFSS STATUS, 2
    RETURN
    CLRF HH
    CLRF HL
    RETURN
    
VERIFICACION_ES3:		; AQUI PODREMOS MODIFICAR EL VALOR DE LA FECHA
    BANKSEL PORTA
    MOVF CONTADOR_ES, W		
    SUBLW 3
    BTFSS STATUS, 2
    GOTO VERIFICACION_ES4
    CALL INC_FECHD
    CALL DEC_FECHD
    CALL INC_FECHA
    CALL DEC_FECHA
    CALL REV_MES
    CALL INC_D
    CALL INC_A
    CALL INC_AH
 
    GOTO DIS_0F
    
INC_FECHD:		    ; SI SE PRESIONA EL BIT 1 DEL PORTB
			    ; SE INCREMENTA EL VALOR DE LOS DIAS
    BTFSS FLAG, 1
    RETURN
    INCF DL
    CLRF FLAG
    RETURN
DEC_FECHD:		    ; SI SE PRESIONA EL BIT 2 DEL PORTB
			    ; SE DECREMENTA EL VALOR DE LOS DIAS
    BTFSS FLAG, 2
    RETURN
    DECF DL
    CLRF FLAG
    RETURN
INC_FECHA:		    ; SI SE PRESIONA EL BIT 3 DEL PORTB
			    ; SE INCREMENTA EL VALOR DE LOS MESES Y DE SU 
			    ; CONTADOR
    BTFSS FLAG, 3
    RETURN
    INCF AL
    INCF CONTADOR_M, F
    CLRF FLAG
    RETURN
DEC_FECHA:		   ; SI SE PRESIONA EL BIT 4 DEL PORTB
			   ; SE DECREMENTA EL VALOR DEL MES Y DE SU CONTADOR
    BTFSS FLAG, 4
    RETURN
    DECF AL
    DECF CONTADOR_M, F
   CLRF FLAG
    RETURN
INC_D:			   ; VERIFICAMOS EL VALOR DE LOS DIAS PARA QUE CUANDO
			   ; LLEGUE A 10 SE REINICIE
    MOVF DL, W
    SUBLW 10
    BTFSS STATUS, 2
    RETURN
    CLRF DL
    INCF DH, F
    RETURN
    
REV_MES:		    ; REVISAMOS EN QUE MES ESTAMOS PARA ASI PODER 
			    ; MODIFICAR LA FECHA DE FORMA CORRECTA
    GOTO ENERO_
    RETURN
ENERO_:
    MOVF CONTADOR_M
    SUBLW 0
    BTFSS STATUS, 2
    GOTO FEBRERO_ 
    MOVF DH, W		
    SUBLW 3		
    BTFSS STATUS, 2	
    RETURN		
    MOVF DL, W
    SUBLW 2
    BTFSS STATUS, 2
    RETURN
    CLRF DH		
    CLRF DL
    INCF DL
    RETURN	

FEBRERO_:
    MOVF CONTADOR_M
    SUBLW 1
    BTFSS STATUS, 2
    GOTO MARZO_
    MOVF DH, W		
    SUBLW 2		
    BTFSS STATUS, 2	
    RETURN		
    MOVF DL, W
    SUBLW 9
    BTFSS STATUS, 2
    RETURN
    CLRF DH		
    CLRF DL
    INCF DL
    RETURN	
    
MARZO_:
    MOVF CONTADOR_M
    SUBLW 2
    BTFSS STATUS, 2
    GOTO ABRIL_
    MOVF DH, W		
    SUBLW 3		
    BTFSS STATUS, 2	
    RETURN		
    MOVF DL, W
    SUBLW 2
    BTFSS STATUS, 2
    RETURN
    CLRF DH		
    CLRF DL
    INCF DL
    RETURN	

ABRIL_:
    MOVF CONTADOR_M
    SUBLW 3
    BTFSS STATUS, 2
    GOTO MAYO_
    MOVF DH, W		
    SUBLW 3		
    BTFSS STATUS, 2	
    RETURN		
    MOVF DL, W
    SUBLW 1
    BTFSS STATUS, 2
    RETURN
    CLRF DH		
    CLRF DL
    INCF DL
    RETURN	
   
MAYO_:
    MOVF CONTADOR_M
    SUBLW 4
    BTFSS STATUS, 2
    GOTO JUNIO_
    MOVF DH, W		
    SUBLW 3		
    BTFSS STATUS, 2	
    RETURN		
    MOVF DL, W
    SUBLW 2
    BTFSS STATUS, 2
    RETURN
    CLRF DH		
    CLRF DL
    INCF DL
    RETURN	
    
JUNIO_:
    MOVF CONTADOR_M
    SUBLW 5
    BTFSS STATUS, 2
    GOTO JULIO_
    MOVF DH, W		
    SUBLW 3		
    BTFSS STATUS, 2	
    RETURN		
    MOVF DL, W
    SUBLW 1
    BTFSS STATUS, 2
    RETURN
    CLRF DH		
    CLRF DL
    INCF DL
    RETURN	
    
JULIO_:
    MOVF CONTADOR_M
    SUBLW 6
    BTFSS STATUS, 2
    GOTO AGOSTO_
    MOVF DH, W		
    SUBLW 3		
    BTFSS STATUS, 2	
    RETURN		
    MOVF DL, W
    SUBLW 2
    BTFSS STATUS, 2
    RETURN
    CLRF DH		
    CLRF DL
    INCF DL
    RETURN	
    
AGOSTO_:
    MOVF CONTADOR_M
    SUBLW 7
    BTFSS STATUS, 2
    GOTO SEPTIEMBRE_
    MOVF DH, W		
    SUBLW 3		
    BTFSS STATUS, 2	
    RETURN		
    MOVF DL, W
    SUBLW 2
    BTFSS STATUS, 2
    RETURN
    CLRF DH		
    CLRF DL
    INCF DL
    RETURN	
    
SEPTIEMBRE_:
    MOVF CONTADOR_M
    SUBLW 8
    BTFSS STATUS, 2
    GOTO OCTUBRE_
    MOVF DH, W		
    SUBLW 3		
    BTFSS STATUS, 2	
    RETURN		
    MOVF DL, W
    SUBLW 1
    BTFSS STATUS, 2
    RETURN
    CLRF DH		
    CLRF DL
    INCF DL
    RETURN	
    
OCTUBRE_:
    MOVF CONTADOR_M
    SUBLW 9
    BTFSS STATUS, 2
    GOTO NOVIEMBRE_
    MOVF DH, W		
    SUBLW 3		
    BTFSS STATUS, 2	
    RETURN		
    MOVF DL, W
    SUBLW 2
    BTFSS STATUS, 2
    RETURN
    CLRF DH		
    CLRF DL
    INCF DL
    RETURN	
    
NOVIEMBRE_:
    MOVF CONTADOR_M
    SUBLW 10
    BTFSS STATUS, 2
    GOTO DICIEMBRE_
    MOVF DH, W		
    SUBLW 3		
    BTFSS STATUS, 2	
    RETURN		
    MOVF DL, W
    SUBLW 1
    BTFSS STATUS, 2
    RETURN
    CLRF DH		
    CLRF DL
    INCF DL
    RETURN	
    
DICIEMBRE_:
    MOVF CONTADOR_M
    SUBLW 11
    BTFSS STATUS, 2
    RETURN
    MOVF DH, W		
    SUBLW 3		
    BTFSS STATUS, 2	
    RETURN		
    MOVF DL, W
    SUBLW 2
    BTFSS STATUS, 2
    RETURN
    CLRF DH		
    CLRF DL
    INCF DL		; CUANDO SE LLEGA AL LIMITE DEL MES SE AUMENTA UNO LA 
			; UNIDAD DEL DIA PORQUE NO HAY DIAS 0
    CLRF CONTADOR_M
    RETURN	
    
INC_A:			; AQUI NOS ASEGURAMOS QUE CUANDO EL VALOR DE LAS 
			; UNIDADES DE MESES LLEGUE A 10 SE REINICIE
    MOVF AL, W
    SUBLW 10
    BTFSS STATUS, 2
    RETURN
    CLRF AL
    INCF AH, F
    RETURN    
INC_AH:			; AQUI CUANDO EL DISPLAY VA A MOSTRAR UN 13 HACEMOS QUE 
			; SE REINICIE
    MOVF AH, W
    SUBLW 1
    BTFSS STATUS, 2
    RETURN
    MOVF AL, W
    SUBLW 3
    BTFSS STATUS, 2
    RETURN
    CLRF AH
    CLRF AL
    INCF AL
    RETURN

VERIFICACION_ES4:	; AQUI COLOCAMOS LA HORA EN LA QUE QUEREMOS QUE
			; SE ACTIVE LA ALARMA
    BANKSEL PORTA
    MOVF CONTADOR_ES, W
    SUBLW 4
    BTFSS STATUS, 2
    GOTO VERIFICACION_ES5
    CALL INC_ALARM
    CALL DEC_ALARM
    CALL INC_ALARH
    CALL DEC_ALARH
    CALL INC_ALM
    CALL INC_ALH
    CALL INC_ALHH
    GOTO DIS_0A		 ; VAMOS AL DIS_0A
INC_ALARM:
    BTFSS FLAG, 1
    RETURN
    INCF ALARMA_ML
    CLRF FLAG
    RETURN
DEC_ALARM:	    
    BTFSS FLAG, 2
    RETURN
    DECF ALARMA_ML
    CLRF FLAG
    RETURN
INC_ALARH:
    BTFSS FLAG, 3
    RETURN
    INCF ALARMA_HL
    CLRF FLAG
    RETURN
DEC_ALARH:	    
    BTFSS FLAG, 4
    RETURN
    DECF ALARMA_HL
    CLRF FLAG
    RETURN
INC_ALM:
    MOVF ML, W
    SUBLW 10
    BTFSS STATUS, 2
    RETURN
    CLRF ALARMA_ML
    INCF ALARMA_MH, F
    MOVF ALARMA_MH, W		
    SUBLW 6		
    BTFSS STATUS, 2	
    RETURN		
    CLRF ALARMA_MH
    RETURN   
INC_ALH:
    MOVF ALARMA_HL, W
    SUBLW 10
    BTFSS STATUS, 2
    RETURN
    CLRF ALARMA_HL
    INCF ALARMA_HH, F
    RETURN    
INC_ALHH:
    MOVF HH, W
    SUBLW 2
    BTFSS STATUS, 2
    RETURN
    MOVF HL, W
    SUBLW 4
    BTFSS STATUS, 2
    RETURN
    CLRF HH
    CLRF HL
    RETURN

    
VERIFICACION_ES5:	    ; AQUI REINICIAMOS EL CONTADOR DE ESTADOS
			    ; TAMBIEN VERIFICAMOS SI LA ALARMA ESTA ENCENDIDA
    BANKSEL PORTA
    CLRF CONTADOR_ES
    BTFSS PORTC, 4
    GOTO DIS_0
    BCF PORTC, 4	    ; SI LA ALARMA ESTA ENCENDIDA AQUI SE APAGA
    CLRF ALARMA_ML
    CLRF ALARMA_MH
    CLRF ALARMA_HL
    CLRF ALARMA_HH
    INCF ALARMA_HL	    ; SE LIMPIAN TODOS LOS VALORES DE LA ALARMA Y SE
			    ; INCREMENTA EN 1 LA HORA PARA QUE NO SE ACTIVE 
			    ; CUANDO SE ENCIENDA EL RELOJ
    GOTO DIS_0
    
;******************************************************************************* 
; MOSTRAR HORA
;*******************************************************************************  
    
DIS_0:			    ; AQUI CARGAREMOS LOS VALORES DE LA HORA AL DISPLAY	    
    MOVF CONT_DIS, W
    ;SUBLW 0		    ; REALIZAMOS UNA COMPARACION DEL VALOR DE CONTADOR
			    ; SI ESTA ES 0 SEGUIMOS EN ESTA SUBRUTINA, SINO
			    ; PASAMOS AL SIGUIENTE DISPLAY
    BTFSS STATUS, 2
    GOTO DIS_1
    MOVF NL, W		; MOVEMOS LO QUE ESTE EN CONTADOR A W
    PAGESEL TABLA	; NOS UBICAMOS EN LA PAGINA DONDE SE ENCUENTRA LA TABLA
    CALL TABLA		; LLAMAMOS A LA TABLA
    PAGESEL DIS_1
    MOVWF PORTD		; MOVEMOS LOS DATOS DE W AL PORTD
    ;INCF CONT_DIS, F
    GOTO VERIFICACION
    
DIS_1:
    MOVF CONT_DIS, W
    SUBLW 1		    ; REALIZAMOS UNA COMPARACION DEL VALOR DE CONTADOR
			    ; SI ESTA ES 1 SEGUIMOS EN ESTA SUBRUTINA, SINO
			    ; PASAMOS AL SIGUIENTE DISPLAY
    BTFSS STATUS, 2
    GOTO DIS_2
    MOVF NH, W		; MOVEMOS LO QUE ESTE EN CONTADOR2 A W
    PAGESEL TABLA
    CALL TABLA		; LLAMAMOS A LA TABLA
    PAGESEL DIS_1
    MOVWF PORTD		; MOVEMOS LOS DATOS DE W AL PORTD
    ;INCF CONT_DIS, F
    GOTO VERIFICACION

DIS_2:
    MOVF CONT_DIS, W
    SUBLW 2		    ; REALIZAMOS UNA COMPARACION DEL VALOR DE CONTADOR
			    ; SI ESTA ES 2 SEGUIMOS EN ESTA SUBRUTINA, SINO
			    ; PASAMOS AL SIGUIENTE DISPLAY
    BTFSS STATUS, 2
    GOTO DIS_3
	
    MOVF ML, W		; MOVEMOS LO QUE ESTE EN CONTADOR2 A W
    PAGESEL TABLA
    CALL TABLA		; LLAMAMOS A LA TABLA
    PAGESEL DIS_1
    MOVWF PORTD		; MOVEMOS LOS DATOS DE W AL PORTD
    ;INCF CONT_DIS, F
    GOTO VERIFICACION
DIS_3:
    MOVF CONT_DIS, W
    SUBLW 3		    ; REALIZAMOS UNA COMPARACION DEL VALOR DE CONTADOR
			    ; SI ESTA ES 3 SEGUIMOS EN ESTA SUBRUTINA, SINO
			    ; PASAMOS AL SIGUIENTE DISPLAY
    BTFSS STATUS, 2
    GOTO DIS_4

    MOVF MH, W		; MOVEMOS LO QUE ESTE EN CONTADOR2 A W
    PAGESEL TABLA
    CALL TABLA		; LLAMAMOS A LA TABLA
    PAGESEL DIS_1
    MOVWF PORTD		; MOVEMOS LOS DATOS DE W AL PORTD
    ;INCF CONT_DIS, F
    GOTO VERIFICACION
    
DIS_4:
    MOVF CONT_DIS, W
    SUBLW 4		    ; REALIZAMOS UNA COMPARACION DEL VALOR DE CONTADOR
			    ; SI ESTA ES 4 SEGUIMOS EN ESTA SUBRUTINA, SINO
			    ; PASAMOS AL SIGUIENTE DISPLAY
    BTFSS STATUS, 2
    GOTO DIS_5

    MOVF HL, W		; MOVEMOS LO QUE ESTE EN CONTADOR2 A W
    PAGESEL TABLA
    CALL TABLA		; LLAMAMOS A LA TABLA
    PAGESEL DIS_1
    MOVWF PORTD		; MOVEMOS LOS DATOS DE W AL PORTD
    ;INCF CONT_DIS, F
    GOTO VERIFICACION
    
DIS_5:
    MOVF CONT_DIS, W
    SUBLW 5	    ; REALIZAMOS UNA COMPARACION DEL VALOR DE CONTADOR
			    ; SI ESTA ES 5 SEGUIMOS EN ESTA SUBRUTINA, SINO
			    ; PASAMOS AL SIGUIENTE DISPLAY
    BTFSS STATUS, 2
    GOTO LOOP

    MOVF HH, W		; MOVEMOS LO QUE ESTE EN CONTADOR2 A W
    PAGESEL TABLA
    CALL TABLA		; LLAMAMOS A LA TABLA
    PAGESEL DIS_1
    MOVWF PORTD		; MOVEMOS LOS DATOS DE W AL PORTD
    
    GOTO VERIFICACION

;******************************************************************************* 
; MOSTRAR FECHA
;*******************************************************************************  
DIS_0F:			    ; AQUI SE CARGAN LOS VALORES DE LA FECHA A LOS 
			    ; DISPLAY
    MOVF CONT_DIS, W
    ;SUBLW 0		    ; REALIZAMOS UNA COMPARACION DEL VALOR DE CONTADOR
			    ; SI ESTA ES 0 SEGUIMOS EN ESTA SUBRUTINA, SINO
			    ; PASAMOS AL SIGUIENTE DISPLAY
    BTFSS STATUS, 2
    GOTO DIS_1F
    MOVF DL, W		; MOVEMOS LO QUE ESTE EN CONTADOR A W
    PAGESEL TABLA	; NOS UBICAMOS EN LA PAGINA DONDE SE ENCUENTRA LA TABLA
    CALL TABLA		; LLAMAMOS A LA TABLA
    PAGESEL DIS_1F
    MOVWF PORTD		; MOVEMOS LOS DATOS DE W AL PORTC
    ;INCF CONT_DIS, F
    GOTO VERIFICACION
    
DIS_1F:
    MOVF CONT_DIS, W
    SUBLW 1		    ; REALIZAMOS UNA COMPARACION DEL VALOR DE CONTADOR
			    ; SI ESTA ES 1 SEGUIMOS EN ESTA SUBRUTINA, SINO
			    ; PASAMOS AL SIGUIENTE DISPLAY
    BTFSS STATUS, 2
    GOTO DIS_2F
    MOVF DH, W		; MOVEMOS LO QUE ESTE EN CONTADOR2 A W
    PAGESEL TABLA
    CALL TABLA		; LLAMAMOS A LA TABLA
    PAGESEL DIS_1F
    MOVWF PORTD		; MOVEMOS LOS DATOS DE W AL PORTD
    ;INCF CONT_DIS, F
    GOTO VERIFICACION

DIS_2F:
    MOVF CONT_DIS, W
    SUBLW 2		    ; REALIZAMOS UNA COMPARACION DEL VALOR DE CONTADOR
			    ; SI ESTA ES 2 SEGUIMOS EN ESTA SUBRUTINA, SINO
			    ; PASAMOS AL SIGUIENTE DISPLAY
    BTFSS STATUS, 2
    GOTO DIS_3F
	
    MOVF AL, W		; MOVEMOS LO QUE ESTE EN CONTADOR2 A W
    PAGESEL TABLA
    CALL TABLA		; LLAMAMOS A LA TABLA
    PAGESEL DIS_1F
    MOVWF PORTD		; MOVEMOS LOS DATOS DE W AL PORTD
    ;INCF CONT_DIS, F
    GOTO VERIFICACION
    
DIS_3F:
    MOVF CONT_DIS, W
    SUBLW 3		    ; REALIZAMOS UNA COMPARACION DEL VALOR DE CONTADOR
			    ; SI ESTA ES 3 SEGUIMOS EN ESTA SUBRUTINA, SINO
			    ; PASAMOS AL SIGUIENTE DISPLAY
    BTFSS STATUS, 2
    GOTO DIS_4F

    MOVF AH, W		; MOVEMOS LO QUE ESTE EN CONTADOR2 A W
    PAGESEL TABLA
    CALL TABLA		; LLAMAMOS A LA TABLA
    PAGESEL DIS_1F
    MOVWF PORTD		; MOVEMOS LOS DATOS DE W AL PORTD
    ;INCF CONT_DIS, F
    GOTO VERIFICACION
    
DIS_4F:
    MOVF CONT_DIS, W
    SUBLW 4		    ; REALIZAMOS UNA COMPARACION DEL VALOR DE CONTADOR
			    ; SI ESTA ES 4 SEGUIMOS EN ESTA SUBRUTINA, SINO
			    ; PASAMOS AL SIGUIENTE DISPLAY
    BTFSS STATUS, 2
    GOTO DIS_5F

    MOVLW 0		; MOVEMOS LO QUE ESTE EN CONTADOR2 A W
    PAGESEL TABLA
    CALL TABLA		; LLAMAMOS A LA TABLA
    PAGESEL DIS_1F
    MOVWF PORTD		; MOVEMOS LOS DATOS DE W AL PORTD
    ;INCF CONT_DIS, F
    GOTO VERIFICACION
    
DIS_5F:
    MOVF CONT_DIS, W
    SUBLW 5	    ; REALIZAMOS UNA COMPARACION DEL VALOR DE CONTADOR
			    ; SI ESTA ES 5 SEGUIMOS EN ESTA SUBRUTINA, SINO
			    ; PASAMOS AL SIGUIENTE DISPLAY
    BTFSS STATUS, 2
    GOTO LOOP

    MOVLW 0		; MOVEMOS LO QUE ESTE EN CONTADOR2 A W
    PAGESEL TABLA
    CALL TABLA		; LLAMAMOS A LA TABLA
    PAGESEL DIS_1F
    MOVWF PORTD		; MOVEMOS LOS DATOS DE W AL PORTD
    
    GOTO VERIFICACION
    
;******************************************************************************* 
; MOSTRAR ALARMA
;*******************************************************************************  
    
DIS_0A:			    ; AQUI CARGAREMOS LOS VALORES DE LA ALARMA EN LOS
			    ; DISPLAU
    MOVF CONT_DIS, W
    ;SUBLW 0		    ; REALIZAMOS UNA COMPARACION DEL VALOR DE CONTADOR
			    ; SI ESTA ES 0 SEGUIMOS EN ESTA SUBRUTINA, SINO
			    ; PASAMOS AL SIGUIENTE DISPLAY
    BTFSS STATUS, 2
    GOTO DIS_1A
    MOVLW 0		; MOVEMOS LO QUE ESTE EN CONTADOR A W
    PAGESEL TABLA	; NOS UBICAMOS EN LA PAGINA DONDE SE ENCUENTRA LA TABLA
    CALL TABLA		; LLAMAMOS A LA TABLA
    PAGESEL DIS_1
    MOVWF PORTD		; MOVEMOS LOS DATOS DE W AL PORTC
    ;INCF CONT_DIS, F
    GOTO VERIFICACION
    
DIS_1A:
    MOVF CONT_DIS, W
    SUBLW 1		    ; REALIZAMOS UNA COMPARACION DEL VALOR DE CONTADOR
			    ; SI ESTA ES 1 SEGUIMOS EN ESTA SUBRUTINA, SINO
			    ; PASAMOS AL SIGUIENTE DISPLAY
    BTFSS STATUS, 2
    GOTO DIS_2A
    MOVLW 0		; MOVEMOS LO QUE ESTE EN CONTADOR2 A W
    PAGESEL TABLA
    CALL TABLA		; LLAMAMOS A LA TABLA
    PAGESEL DIS_1
    MOVWF PORTD		; MOVEMOS LOS DATOS DE W AL PORTD
    ;INCF CONT_DIS, F
    GOTO VERIFICACION

DIS_2A:
    MOVF CONT_DIS, W
    SUBLW 2		    ; REALIZAMOS UNA COMPARACION DEL VALOR DE CONTADOR
			    ; SI ESTA ES 2 SEGUIMOS EN ESTA SUBRUTINA, SINO
			    ; PASAMOS AL SIGUIENTE DISPLAY
    BTFSS STATUS, 2
    GOTO DIS_3A
	
    MOVF ALARMA_ML, W		; MOVEMOS LO QUE ESTE EN CONTADOR2 A W
    PAGESEL TABLA
    CALL TABLA		; LLAMAMOS A LA TABLA
    PAGESEL DIS_1
    MOVWF PORTD		; MOVEMOS LOS DATOS DE W AL PORTD
    ;INCF CONT_DIS, F
    GOTO VERIFICACION
DIS_3A:
    MOVF CONT_DIS, W
    SUBLW 3		    ; REALIZAMOS UNA COMPARACION DEL VALOR DE CONTADOR
			    ; SI ESTA ES 3 SEGUIMOS EN ESTA SUBRUTINA, SINO
			    ; PASAMOS AL SIGUIENTE DISPLAY
    BTFSS STATUS, 2
    GOTO DIS_4A

    MOVF ALARMA_MH, W		; MOVEMOS LO QUE ESTE EN CONTADOR2 A W
    PAGESEL TABLA
    CALL TABLA		; LLAMAMOS A LA TABLA
    PAGESEL DIS_1
    MOVWF PORTD		; MOVEMOS LOS DATOS DE W AL PORTD
    ;INCF CONT_DIS, F
    GOTO VERIFICACION
    
DIS_4A:
    MOVF CONT_DIS, W
    SUBLW 4		    ; REALIZAMOS UNA COMPARACION DEL VALOR DE CONTADOR
			    ; SI ESTA ES 4 SEGUIMOS EN ESTA SUBRUTINA, SINO
			    ; PASAMOS AL SIGUIENTE DISPLAY
    BTFSS STATUS, 2
    GOTO DIS_5A

    MOVF ALARMA_HL, W		; MOVEMOS LO QUE ESTE EN CONTADOR2 A W
    PAGESEL TABLA
    CALL TABLA		; LLAMAMOS A LA TABLA
    PAGESEL DIS_1
    MOVWF PORTD		; MOVEMOS LOS DATOS DE W AL PORTD
    ;INCF CONT_DIS, F
    GOTO VERIFICACION
    
DIS_5A:
    MOVF CONT_DIS, W
    SUBLW 5	    ; REALIZAMOS UNA COMPARACION DEL VALOR DE CONTADOR
			    ; SI ESTA ES 5 SEGUIMOS EN ESTA SUBRUTINA, SINO
			    ; PASAMOS AL SIGUIENTE DISPLAY
    BTFSS STATUS, 2
    GOTO LOOP

    MOVF ALARMA_HH, W		; MOVEMOS LO QUE ESTE EN CONTADOR2 A W
    PAGESEL TABLA
    CALL TABLA		; LLAMAMOS A LA TABLA
    PAGESEL DIS_1
    MOVWF PORTD		; MOVEMOS LOS DATOS DE W AL PORTD
    
    GOTO VERIFICACION
    
VERIFICACION:		; AQUI COMPARAMOS LOS VALORES DE LA ALARMA Y LOS 
			; COMPARAMOS CON LOS VALORES DE LA HORA ACTUAL
    MOVF ALARMA_ML, W
    SUBWF ML, W
    BTFSS STATUS, 2
    GOTO VERIFICACION2
    MOVF ALARMA_MH, W
    SUBWF MH, W
    BTFSS STATUS, 2
    GOTO VERIFICACION2
    MOVF ALARMA_HL, W
    SUBWF HL, W
    BTFSS STATUS, 2
    GOTO VERIFICACION2
    MOVF ALARMA_HH, W
    SUBWF HH, W
    BTFSS STATUS, 2
    GOTO VERIFICACION2
    BSF PORTC, 4
    GOTO VERIFICACION2
    
    
    
VERIFICACION2:
    MOVF NL, W		; MOVEMOS LOS DATOS DE CONTADOR A W
    SUBLW 10		; SE LO RESTAMOS A 10
    BTFSS STATUS, 2	; SI EL RESULTADO ES 0 NOS SALTAMOS GOTO LOOP
    GOTO LOOP		; CAMOS A LOOP
    CLRF NL		; CARGAMOS UN 0 A W
    INCF NH, F
    GOTO VERIFICACION3	; VAMOS A VERIFICACION3

VERIFICACION3:
    MOVF NH, W		; MOVEMOS LOS DATOS DEL CONTADOR2 A W
    SUBLW 6		; LE RESTAMOS 6
    BTFSS STATUS, 2	; SI LA RESTA ES 0 NOS SALTAMOS EL GOTO LOOP
    GOTO LOOP		; VAMOS A LOOP
    CLRF NH		; LIMPIAMOS LA VARIABLE DE CONTADOR2
    INCF ML, F
    GOTO VERIFICACION4	; VAMOS A VERIFICACION4
    
VERIFICACION4:		; NOS ASEGURAMOS QUE EL VALOR DE LAS UNIDADES DE MINUTO
			; NO PASEN DE 10
    MOVF ML, W
    SUBLW 10
    BTFSS STATUS, 2
    GOTO LOOP
    CLRF ML
    INCF MH, F		; CUANDO LAS UNIDADES DE MINUTOS LLEGUEN A 10 SE 
			; INCREMENTARA EL VALOR DE LAS DECENAS
    GOTO VERIFICACION5

VERIFICACION5:
    MOVF MH, W		; MOVEMOS LOS DATOS DEL CONTADOR2 A W
    SUBLW 6		; LE RESTAMOS 6
    BTFSS STATUS, 2	; SI LA RESTA ES 0 NOS SALTAMOS EL GOTO LOOP
    GOTO LOOP		; VAMOS A  LOOP
    CLRF MH		; LIMPIAMOS LA VARIABLE DE CONTADOR2
    INCF HL		; SI LLEGAMOS A 6 EN LA VARIABLE DE DECENAS DE MINUTOS
			; INCREMENTAMOS LAS UNIDADES DE HORAS
    GOTO VERIFICACION6	; VAMOS A VERIFICACION
    
VERIFICACION6:		; DE IGUAL FORMA NOS ASEGURAMOS QUE LAS UNIDADES DE HORA
			; AL LLEGAR A 10 SE REINICIEN Y AUMENTEN LAS DECENAS DE 
			; HORA
    MOVF HL, W
    SUBLW 10
    BTFSS STATUS, 2
    GOTO LOOP
    CLRF HL
    INCF HH, F
    GOTO VERIFICACION7
    
VERIFICACION7:
    MOVF HH, W		; MOVEMOS LOS DATOS DE LA VARIABLE A W
    SUBLW 2		; LE RESTAMOS 2
    BTFSS STATUS, 2	; SI LA RESTA ES 0 NOS SALTAMOS EL GOTO LOOP
    GOTO LOOP		; VAMOS A LOOP
    MOVF HL, W		; MOVEMOS LOS DATOS DE LA VARIABLE A W
    SUBLW 4		; LE RESTAMOS 4, SI LA RESTA ES 0 NOS SALTAMOS EL GOTO
			; LOOP
    BTFSS STATUS, 2
    GOTO LOOP		 
    CLRF HH		;LIMPIAMOS LA VARIABLE DE DECENAS Y UNIDADES DE HORAS
    CLRF HL
    INCF DL, F		; INCREMENTAMOS LA VARIABLE DE DIAS
    GOTO VERIFICACION8	; VAMOS A VERIFICACION8
    
VERIFICACION8:	; NOS ASEGURAMOS DE QUE CUANDO PASEN 10 DIAS AUMENTE LA VARIABLE
		; DE DECENAS DE DIAS
    MOVF DL, W
    SUBLW 10
    BTFSS STATUS, 2
    GOTO LOOP
    CLRF DL
    INCF DH, F
    GOTO ENERO
    
ENERO:			; NOS ASEGURAMOS DE VER EN QUE MES ESTAMOS PARA ASI
			; TENER UN LIMITE ADECUADO DE DIAS, Y SI TODOS LOS
			; CRITERIOS SE CUMPLEN, SE AUMENTA UN MES Y SE REINICIAN
			; LOS DIAS
    MOVF CONTADOR_M
    SUBLW 0
    BTFSS STATUS, 2
    GOTO FEBRERO
    MOVF DH, W		; MOVEMOS LOS DATOS DEL CONTADOR2 A W
    SUBLW 3		; LE RESTAMOS 6
    BTFSS STATUS, 2	; SI LA RESTA ES 0 NOS SALTAMOS EL GOTO VERIFICACION
    GOTO LOOP		; VAMOS A 
    MOVF DL, W
    SUBLW 2
    BTFSS STATUS, 2
    GOTO LOOP
    CLRF DH		; LIMPIAMOS LA VARIABLE DE CONTADOR2
    CLRF DL
    INCF DL, F
    INCF AL, F
    INCF CONTADOR_M
    GOTO LOOP	; VAMOS A VERIFICACION

FEBRERO:
    MOVF CONTADOR_M
    SUBLW 1
    BTFSS STATUS, 2
    GOTO MARZO
    MOVF DH, W		; MOVEMOS LOS DATOS DEL CONTADOR2 A W
    SUBLW 2		; LE RESTAMOS 6
    BTFSS STATUS, 2	; SI LA RESTA ES 0 NOS SALTAMOS EL GOTO VERIFICACION
    GOTO LOOP		; VAMOS A 
    MOVF DL, W
    SUBLW 9
    BTFSS STATUS, 2
    GOTO LOOP
    CLRF DH		; LIMPIAMOS LA VARIABLE DE CONTADOR2
    CLRF DL
    INCF DL, F
    INCF AL, F
    INCF CONTADOR_M
    GOTO LOOP	; VAMOS A VERIFICACION
    
MARZO:
    MOVF CONTADOR_M
    SUBLW 2
    BTFSS STATUS, 2
    GOTO ABRIL
    MOVF DH, W		; MOVEMOS LOS DATOS DEL CONTADOR2 A W
    SUBLW 3		; LE RESTAMOS 6
    BTFSS STATUS, 2	; SI LA RESTA ES 0 NOS SALTAMOS EL GOTO VERIFICACION
    GOTO LOOP		; VAMOS A 
    MOVF DL, W
    SUBLW 2
    BTFSS STATUS, 2
    GOTO LOOP
    CLRF DH		; LIMPIAMOS LA VARIABLE DE CONTADOR2
    CLRF DL
    INCF DL, F
    INCF AL, F
    INCF CONTADOR_M
    GOTO LOOP	; VAMOS A VERIFICACION

ABRIL:
    MOVF CONTADOR_M
    SUBLW 3
    BTFSS STATUS, 2
    GOTO MAYO
    MOVF DH, W		; MOVEMOS LOS DATOS DEL CONTADOR2 A W
    SUBLW 3		; LE RESTAMOS 6
    BTFSS STATUS, 2	; SI LA RESTA ES 0 NOS SALTAMOS EL GOTO VERIFICACION
    GOTO LOOP		; VAMOS A 
    MOVF DL, W
    SUBLW 1
    BTFSS STATUS, 2
    GOTO LOOP
    CLRF DH		; LIMPIAMOS LA VARIABLE DE CONTADOR2
    CLRF DL
    INCF DL, F
    INCF AL, F
    INCF CONTADOR_M
    GOTO LOOP	; VAMOS A VERIFICACION
   
MAYO:
    MOVF CONTADOR_M
    SUBLW 4
    BTFSS STATUS, 2
    GOTO JUNIO
    MOVF DH, W		; MOVEMOS LOS DATOS DEL CONTADOR2 A W
    SUBLW 3		; LE RESTAMOS 6
    BTFSS STATUS, 2	; SI LA RESTA ES 0 NOS SALTAMOS EL GOTO VERIFICACION
    GOTO LOOP		; VAMOS A 
    MOVF DL, W
    SUBLW 2
    BTFSS STATUS, 2
    GOTO LOOP
    CLRF DH		; LIMPIAMOS LA VARIABLE DE CONTADOR2
    CLRF DL
    INCF DL, F
    INCF AL, F
    INCF CONTADOR_M
    GOTO LOOP	; VAMOS A VERIFICACION
    
JUNIO:
    MOVF CONTADOR_M
    SUBLW 5
    BTFSS STATUS, 2
    GOTO JULIO
    MOVF DH, W		; MOVEMOS LOS DATOS DEL CONTADOR2 A W
    SUBLW 3		; LE RESTAMOS 6
    BTFSS STATUS, 2	; SI LA RESTA ES 0 NOS SALTAMOS EL GOTO VERIFICACION
    GOTO LOOP		; VAMOS A 
    MOVF DL, W
    SUBLW 1
    BTFSS STATUS, 2
    GOTO LOOP
    CLRF DH		; LIMPIAMOS LA VARIABLE DE CONTADOR2
    CLRF DL
    INCF DL, F
    INCF AL, F
    INCF CONTADOR_M
    GOTO LOOP	; VAMOS A VERIFICACION
    
JULIO:
    MOVF CONTADOR_M
    SUBLW 6
    BTFSS STATUS, 2
    GOTO AGOSTO
    MOVF DH, W		; MOVEMOS LOS DATOS DEL CONTADOR2 A W
    SUBLW 3		; LE RESTAMOS 6
    BTFSS STATUS, 2	; SI LA RESTA ES 0 NOS SALTAMOS EL GOTO VERIFICACION
    GOTO LOOP		; VAMOS A 
    MOVF DL, W
    SUBLW 2
    BTFSS STATUS, 2
    GOTO LOOP
    CLRF DH		; LIMPIAMOS LA VARIABLE DE CONTADOR2
    CLRF DL
    INCF DL, F
    INCF AL, F
    INCF CONTADOR_M
    GOTO LOOP	; VAMOS A VERIFICACION
    
AGOSTO:
    MOVF CONTADOR_M
    SUBLW 7
    BTFSS STATUS, 2
    GOTO SEPTIEMBRE
    MOVF DH, W		; MOVEMOS LOS DATOS DEL CONTADOR2 A W
    SUBLW 3		; LE RESTAMOS 6
    BTFSS STATUS, 2	; SI LA RESTA ES 0 NOS SALTAMOS EL GOTO VERIFICACION
    GOTO LOOP		; VAMOS A 
    MOVF DL, W
    SUBLW 2
    BTFSS STATUS, 2
    GOTO LOOP
    CLRF DH		; LIMPIAMOS LA VARIABLE DE CONTADOR2
    CLRF DL
    INCF DL, F
    INCF AL, F
    INCF CONTADOR_M
    GOTO LOOP	; VAMOS A VERIFICACION
    
SEPTIEMBRE:
    MOVF CONTADOR_M
    SUBLW 8
    BTFSS STATUS, 2
    GOTO OCTUBRE
    MOVF DH, W		; MOVEMOS LOS DATOS DEL CONTADOR2 A W
    SUBLW 3		; LE RESTAMOS 6
    BTFSS STATUS, 2	; SI LA RESTA ES 0 NOS SALTAMOS EL GOTO VERIFICACION
    GOTO LOOP		; VAMOS A 
    MOVF DL, W
    SUBLW 1
    BTFSS STATUS, 2
    GOTO LOOP
    CLRF DH		; LIMPIAMOS LA VARIABLE DE CONTADOR2
    CLRF DL
    INCF DL, F
    INCF AL, F
    INCF CONTADOR_M
    GOTO LOOP	; VAMOS A VERIFICACION
    
OCTUBRE:
    MOVF CONTADOR_M
    SUBLW 9
    BTFSS STATUS, 2
    GOTO NOVIEMBRE
    MOVF DH, W		; MOVEMOS LOS DATOS DEL CONTADOR2 A W
    SUBLW 3		; LE RESTAMOS 6
    BTFSS STATUS, 2	; SI LA RESTA ES 0 NOS SALTAMOS EL GOTO VERIFICACION
    GOTO LOOP		; VAMOS A 
    MOVF DL, W
    SUBLW 2
    BTFSS STATUS, 2
    GOTO LOOP
    CLRF DH		; LIMPIAMOS LA VARIABLE DE CONTADOR2
    CLRF DL
    CLRF DL
    INCF DL, F
    INCF AL, F
    INCF CONTADOR_M
    GOTO LOOP	; VAMOS A VERIFICACION
    
NOVIEMBRE:
    MOVF CONTADOR_M
    SUBLW 10
    BTFSS STATUS, 2
    GOTO DICIEMBRE
    MOVF DH, W		; MOVEMOS LOS DATOS DEL CONTADOR2 A W
    SUBLW 3		; LE RESTAMOS 6
    BTFSS STATUS, 2	; SI LA RESTA ES 0 NOS SALTAMOS EL GOTO VERIFICACION
    GOTO LOOP		; VAMOS A 
    MOVF DL, W
    SUBLW 1
    BTFSS STATUS, 2
    GOTO LOOP
    CLRF DH		; LIMPIAMOS LA VARIABLE DE CONTADOR2
    CLRF DL
    INCF DL, F
    INCF AL, F
    INCF CONTADOR_M
    GOTO LOOP	; VAMOS A VERIFICACION
    
DICIEMBRE:
    MOVF CONTADOR_M
    SUBLW 11
    BTFSS STATUS, 2
    GOTO LOOP
    MOVF DH, W		; MOVEMOS LOS DATOS DEL CONTADOR2 A W
    SUBLW 3		; LE RESTAMOS 6
    BTFSS STATUS, 2	; SI LA RESTA ES 0 NOS SALTAMOS EL GOTO VERIFICACION
    GOTO LOOP		; VAMOS A 
    MOVF DL, W
    SUBLW 2
    BTFSS STATUS, 2
    GOTO LOOP
    CLRF DH		; LIMPIAMOS LA VARIABLE DE CONTADOR2
    CLRF DL
    INCF DL, F
    INCF AL, F
    CLRF CONTADOR_M
    GOTO LOOP	; VAMOS A VERIFICACION

PSECT CODE, ABS, DELTA=2
 ORG 0x64
 TABLA:
    ADDWF PCL, F
    RETLW 0b00111111	; 0
    RETLW 0b00000110	; 1
    RETLW 0b01011011	; 2
    RETLW 0b01001111	; 3
    RETLW 0b01100110	; 4
    RETLW 0b01101101	; 5
    RETLW 0b01111101
    RETLW 0b00000111
    RETLW 0b01111111
    RETLW 0b01101111
    RETLW 0b01110111
    RETLW 0b01111100
    RETLW 0b00111001
    RETLW 0b01011110
    RETLW 0b01111001
    RETLW 0b01110001
;******************************************************************************* 
; Fin de CÃƒÂ³digo    
;******************************************************************************* 
END   
